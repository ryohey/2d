(this.webpackJsonp2d=this.webpackJsonp2d||[]).push([[0],{16:function(module,__webpack_exports__,__webpack_require__){"use strict";function createFunction(code){return eval("() => { return ".concat(code," }"))()}__webpack_require__.d(__webpack_exports__,"a",(function(){return createFunction})),__webpack_require__.d(__webpack_exports__,"b",(function(){return getParamNames}));var STRIP_COMMENTS=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,ARGUMENT_NAMES=/([^\s,]+)/g;function getParamNames(e){var n=e.toString().replace(STRIP_COMMENTS,""),t=n.slice(n.indexOf("(")+1,n.indexOf(")")).match(ARGUMENT_NAMES);return null===t?[]:t}},21:function(e,n,t){"use strict";t.d(n,"a",(function(){return s}));var r=t(5),o=function e(n,t){return t(n,n.children.map((function(n){return e(n,t)})))},c=function e(n,t){var r=n.edges.filter((function(e){return e.toId===t.id})).map((function(t){var r=n.nodes.filter((function(e){return e.id===t.fromId}));if(0===r.length)throw new Error("node id ".concat(t.fromId," is not exist"));if(r.length>1)throw new Error("There are multiple nodes for id ".concat(t.fromId));var o=r[0];return e(n,o)}));return{value:t,children:r}},a=function(e){return function(e){return e.nodes.filter((function(n){return 0===e.edges.filter((function(e){return e.fromId===n.id})).length&&e.edges.filter((function(e){return e.toId===n.id})).length>0}))}(e).map((function(n){return c(e,n)}))},i=function(e){var n=e.name?"".concat(e.name):"func".concat(e.id);return void 0!==window[n]?"__".concat(n):n},u=function(e,n,t){var r,o=i(e),c="".concat(e.name,"_out").concat(n),a=t.filter((function(e){return e.isPromise})).map((function(e){return e.varName}));return r=0===a.length?"const ".concat(c," = ").concat(o,"(").concat(t.map((function(e){return e.varName})).join(", "),")"):"const ".concat(c," = Promise.all([\n      ").concat(a.join(", "),"\n    ]).then(result => {\n      const [").concat(a.map((function(e){return e+"_p"})).join(", "),"] = result\n      return ").concat(o,"(").concat(t.map((function(e){return e.isPromise?e.varName+"_p":e.varName})).join(", "),")\n    })"),{code:t.map((function(e){return e.code})).join("\n")+"\n"+r,varName:c,isPromise:e.isAsync||t.some((function(e){return e.isPromise}))}};function s(e){var n=e.nodes,t=a(e),c=n.filter(r.a).map((function(e){var n=i(e);return"const ".concat(n," = ").concat(e.code)})).join("\n"),s=function e(t){switch(t.type){case"FuncNode":return t;case"ReferenceFuncNode":var o=n.filter((function(e){return e.id===t.reference}))[0];if(Object(r.a)(o))return o;if(Object(r.b)(o))return e(o);throw new Error("Origin node is not FuncNode")}};return c+"\n"+t.map((function(e){return o(e,(function(e,n){switch(e.value.type){case"FuncNode":return u(e.value,e.value.id,n);case"ReferenceFuncNode":var t=s(e.value);return u(t,e.value.id,n);case"VariableNode":return function(e){var n=i(e);return{code:"const ".concat(n," = ").concat(e.value.value),varName:n,isPromise:!1}}(e.value)}}))})).map((function(e){return e.code})).join("\n")}},3:function(e,n,t){"use strict";t.d(n,"d",(function(){return f})),t.d(n,"e",(function(){return m})),t.d(n,"g",(function(){return x})),t.d(n,"j",(function(){return y})),t.d(n,"l",(function(){return E})),t.d(n,"k",(function(){return g})),t.d(n,"m",(function(){return P})),t.d(n,"n",(function(){return N})),t.d(n,"a",(function(){return M})),t.d(n,"o",(function(){return k})),t.d(n,"i",(function(){return D})),t.d(n,"h",(function(){return C})),t.d(n,"b",(function(){return w})),t.d(n,"c",(function(){return I})),t.d(n,"f",(function(){return R}));var r=t(2),o=t(28),c=t(12),a=t(22),i=t.n(a),u=t(16);function s(e){return null!==e&&void 0!==e}var d=t(5),l=function(e){return function(n){var t=e.find((function(e){return e.id===n}));if(void 0===t)throw new Error("node ".concat(n," does not exist"));return t}},_=function(e){return function(n){var t=l(e)(n);if(!Object(d.a)(t)&&!Object(d.b)(t))throw new Error("node is not FuncNode");return t}},b=function e(n){return function(t){var r=l(n)(t);switch(r.type){case"FuncNode":return r;case"ReferenceFuncNode":return e(n)(r.reference);case"VariableNode":throw new Error("origin node is not exist")}}},j=function(e){return function(n){var t=l(e)(n);if(void 0===t||!Object(d.a)(t)&&!Object(d.b)(t))return null;var r=b(e)(n);return{id:t.id,type:"FuncNode",x:t.x,y:t.y,linked:Object(d.b)(t),name:r.name,isAsync:r.isAsync,code:r.code,inputNames:O(e)(n)}}},f=function(e){return e.map((function(n){return j(e)(n.id)})).filter(s)},O=function(e){return function(n){var t=l(e)(n);if(void 0===t)return[];if(Object(d.b)(t)&&(t=l(e)(t.reference)),void 0===t)return[];if(!Object(d.a)(t))return[];var r=Object(u.a)(t.code);return Object(u.b)(r)}},p=function(e){var n=i.a.max(e.map((function(e){return e.id})));return void 0!==n?n:-1},m=function(e,n){return{type:"FuncNode",x:e,y:n,name:"func",code:"x => x",isAsync:!1,id:-1}},v=function(e,n){return[].concat(Object(o.a)(e),[Object(r.a)(Object(r.a)({},n),{},{id:p(e)+1})])},x=Object(c.b)({name:"graph",initialState:{current:{nodes:[{type:"FuncNode",name:"constant",code:"() => 1",x:44,y:26,id:0},{type:"FuncNode",name:"time",code:"() => 1000",x:49,y:165,id:1},{type:"FuncNode",name:"delay",code:"(value, delay) => new Promise((resolve, reject) => {\n  setTimeout(() => resolve(value), delay)\n})",x:183,y:26,isAsync:!0,id:2},{type:"FuncNode",name:"constant2",code:"() => 2",x:367,y:110,id:3},{type:"FuncNode",name:"time2",code:"() => 2000",x:377,y:247,id:4},{type:"ReferenceFuncNode",reference:2,x:518,y:111,id:5},{type:"FuncNode",id:6,x:650.6666564941406,y:26,name:"add",code:"(a, b) => a + b"},{type:"FuncNode",name:"popup",code:"str => alert(str)",x:815,y:27,id:7}],edges:[{fromId:0,toId:2,toIndex:0},{fromId:1,toId:2,toIndex:1},{fromId:3,toId:5,toIndex:0},{fromId:4,toId:5,toIndex:1},{fromId:5,toId:6,toIndex:1},{fromId:2,toId:6,toIndex:0},{fromId:6,toId:7,toIndex:0}]},editingNode:null,previewEdge:null,previewNode:null},reducers:{setEdges:function(e,n){e.current.edges=n.payload},setNodes:function(e,n){e.current.nodes=n.payload},setEditingNode:function(e,n){e.editingNode=n.payload},setPreviewEdge:function(e,n){e.previewEdge=n.payload},setPreviewNode:function(e,n){e.previewNode=n.payload},addNode:function(e,n){var t=e.current.nodes;e.current.nodes=v(t,n.payload)},dupulicateNode:function(e,n){var t=e.current.nodes,o=_(t)(n.payload);e.current.nodes=v(t,Object(r.a)(Object(r.a)({},o),{},{y:o.y+180}))},addReferenceFuncNode:function(e,n){var t=e.current.nodes,r=n.payload,o=_(t)(r),c=Object(d.b)(o)?o.reference:r;e.current.nodes=v(t,{type:"ReferenceFuncNode",reference:c,x:o.x,y:o.y+180})},updateNode:function(e,n){e.current.nodes=e.current.nodes.map((function(e){return e.id!==n.payload.id?e:Object(r.a)(Object(r.a)({},e),n.payload.obj)}))},addEdge:function(e,n){var t=n.payload;i.a.find(e.current.edges,t)||(e.current.edges=[].concat(Object(o.a)(e.current.edges),[t]))},removeNode:function(e,n){var t=e.current.nodes,r=n.payload,o=(l(t)(r),e.current.nodes.filter((function(e){return e.id===r||Object(d.b)(e)&&e.reference==r})).map((function(e){return e.id})));e.current={nodes:e.current.nodes.filter((function(e){return!o.includes(e.id)})),edges:e.current.edges.filter((function(e){return!o.includes(e.fromId)&&!o.includes(e.toId)}))}},removeEdge:function(e,n){var t=n.payload;e.current.edges=e.current.edges.filter((function(e){return e.fromId!==t}))}}}),h=x.actions,y=h.setEdges,E=h.setNodes,g=h.setEditingNode,P=h.setPreviewEdge,N=h.setPreviewNode,M=h.addEdge,k=h.updateNode,D=h.removeNode,C=h.removeEdge,w=h.addNode,I=h.addReferenceFuncNode,R=h.dupulicateNode},4:function(e,n,t){"use strict";t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return c}));var r=t(17),o=function(){return Object(r.b)()},c=r.c},40:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Toolbar}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_components_Icon__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(8),_helpers_buildCode__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(21),_hooks__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(4),_stores_GraphStore__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(3),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(0),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__),Toolbar=function Toolbar(_ref){var onClickHelp=_ref.onClickHelp,graph=Object(_hooks__WEBPACK_IMPORTED_MODULE_3__.b)((function(e){return e.graph.current})),dispatch=Object(_hooks__WEBPACK_IMPORTED_MODULE_3__.a)(),onClickPlay=function onClickPlay(){var code=Object(_helpers_buildCode__WEBPACK_IMPORTED_MODULE_2__.a)(graph);eval(code)},onClickClear=function(){dispatch(Object(_stores_GraphStore__WEBPACK_IMPORTED_MODULE_4__.j)([])),dispatch(Object(_stores_GraphStore__WEBPACK_IMPORTED_MODULE_4__.l)([]))};return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)("div",{className:"Toolbar",children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("a",{className:"ToolbarButton",onClick:onClickPlay,children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_components_Icon__WEBPACK_IMPORTED_MODULE_1__.a,{name:"play"})}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("a",{className:"ToolbarButton",onClick:onClickClear,children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_components_Icon__WEBPACK_IMPORTED_MODULE_1__.a,{name:"delete"})}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("a",{className:"ToolbarButton",target:"_blank",href:"https://github.com/ryohey/2d",children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_components_Icon__WEBPACK_IMPORTED_MODULE_1__.a,{name:"github-circle"})}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("a",{className:"ToolbarButton",onClick:onClickHelp,children:"Help"})]})}},41:function(module,__webpack_exports__,__webpack_require__){"use strict";var _Users_ryohey_Repository_2d_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),_functionHelper__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(16);__webpack_exports__.a=function(){var codes=[{code:'() => "Hello"',name:"helloStr"},{code:"msg => console.log(msg)",name:"log"},{code:"msg => alert(msg)",name:"alert"},{code:"url => fetch(url)",name:"fetch",isAsync:!0}];return codes.map((function(c){var func=eval("() => { return ".concat(c.code," }"))();return Object(_Users_ryohey_Repository_2d_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__.a)(Object(_Users_ryohey_Repository_2d_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__.a)({},c),{},{inputNames:Object(_functionHelper__WEBPACK_IMPORTED_MODULE_1__.b)(func)})}))}},5:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return c}));var r=function(e){return"FuncNode"===e.type},o=function(e){return"ReferenceFuncNode"===e.type},c=function(e){return"VariableNode"===e.type}},61:function(e,n,t){},63:function(e,n,t){},65:function(e,n,t){},66:function(e,n,t){},67:function(e,n,t){"use strict";t.r(n);var r,o,c=t(1),a=t(14),i=t.n(a),u=t(17),s=t(2),d=t(6),l=t(27),_=t(0),b=Object(c.createContext)([{startData:null,startPosition:null,container:null,handler:null},function(){}]),j=function(e){var n=e.onMouseDown,t=e.onMouseDragMove,r=e.onMouseUp,o=e.children,a=Object(l.a)(e,["onMouseDown","onMouseDragMove","onMouseUp","children"]),i=Object(c.useState)({startData:null,startPosition:null,container:null}),u=Object(d.a)(i,2),j=u[0],O=u[1],p=Object(c.useRef)(null);return Object(c.useEffect)((function(){O((function(e){return Object(s.a)(Object(s.a)({},e),{},{container:p.current})}))}),[]),Object(_.jsx)(b.Provider,{value:[Object(s.a)(Object(s.a)({},j),{},{handler:{onMouseDown:n,onMouseDragMove:t,onMouseUp:r}}),O],children:Object(_.jsx)(f,Object(s.a)(Object(s.a)({data:null,onMount:p},a),{},{children:o}))})},f=function(e){var n=e.data,t=e.onMount,r=Object(l.a)(e,["data","onMount"]),o=Object(c.useContext)(b),a=Object(d.a)(o,2),i=a[0],u=a[1],j=function(e){var n=null!==i.container?{x:i.container.offsetLeft,y:i.container.offsetTop}:{x:0,y:0};return{x:e.pageX-n.x,y:e.pageY-n.y}};return Object(_.jsx)("div",Object(s.a)(Object(s.a)({},r),{},{ref:t,onMouseDown:function(e){e.stopPropagation(),null!==i.handler&&(u(Object(s.a)(Object(s.a)({},i),{},{startData:n,startPosition:j(e)})),i.handler.onMouseDown({originEvent:e,start:n}))},onMouseMove:function(e){if(e.stopPropagation(),null!==i.handler&&null!==i.startPosition){var n=j(e);i.handler.onMouseDragMove({originEvent:e,startPosition:i.startPosition,movement:{x:n.x-i.startPosition.x,y:n.y-i.startPosition.y},start:i.startData})}},onMouseUp:function(e){if(e.stopPropagation(),null!==i.handler&&null!==i.startPosition&&null!==i.container){u(Object(s.a)(Object(s.a)({},i),{},{startData:null,startPosition:null}));var t=j(e);i.handler.onMouseUp({originEvent:e,startPosition:i.startPosition,movement:{x:t.x-i.startPosition.x,y:t.y-i.startPosition.y},start:i.startData,end:n})}}}))},O=t(18),p=t.n(O),m=function(){return Object(_.jsxs)("div",{children:[Object(_.jsx)("h1",{children:"Help"}),Object(_.jsxs)("dl",{children:[Object(_.jsx)("dt",{children:"Create blocks"}),Object(_.jsx)("dd",{children:"Double-click on the stage."}),Object(_.jsx)("dt",{children:"Edit blocks"}),Object(_.jsx)("dd",{children:"Double-click on the block. Edit the code."}),Object(_.jsx)("dt",{children:"Remove blocks"}),Object(_.jsx)("dd",{children:"Click the downward arrow on the block. Select remove."}),Object(_.jsx)("dt",{children:"Run"}),Object(_.jsx)("dd",{children:"Click the play button. The graph will be evaluated as JavaScript. You should add the output block that runs alert() or console.log() to see the result."})]})]})},v=function(e){var n=e.isOpen,t=e.close;return Object(_.jsx)(p.a,{contentLabel:"help",isOpen:n,onRequestClose:t,overlayClassName:"HelpModalOverlay",className:"HelpModal",children:Object(_.jsx)(m,{})})},x=t(21),h=t(4),y=t(3),E=(t(61),t(35)),g=function(e){var n=e.draw,t=e.width,r=e.height,o=Object(c.useState)(null),a=Object(d.a)(o,2),i=a[0],u=a[1];if(null!==i){i.width=t,i.height=r;var s=i.getContext("2d");s&&n(s)}return Object(_.jsx)("canvas",{ref:u,width:t,height:r})},P=t(19),N=t(20),M=N.a.div(r||(r=Object(P.a)(["\n  position: absolute;\n  background: var(--background-color);\n  padding: 0.5em 0em;\n  font-size: 90%;\n  width: 10em;\n  z-index: 100;\n  box-shadow: 0 2px 9px rgba(0, 0, 0, 0.24);\n\n  > div {\n    padding: 0.5em;\n\n    &:hover {\n      background: var(--secondary-background-color);\n    }\n  }\n"]))),k=function(e){var n=e.items,t=e.onRequestClose,r=e.position;return Object(_.jsx)(M,{style:void 0!==r?{left:r.x,top:r.y}:{},children:n.map((function(e,n){return Object(_.jsx)("div",{onClick:function(n){t(),e.onClick(n)},children:e.name},n)}))})},D=t(5),C=function(e){var n=e.closeModal,t=e.node,r=Object(c.useState)(t),o=Object(d.a)(r,2),a=o[0],i=o[1],u=Object(h.a)();return Object(_.jsx)(p.a,{contentLabel:"edit block",isOpen:!0,onRequestClose:n,overlayClassName:"BlockModalOverlay",className:"BlockModal",children:Object(_.jsxs)("form",{onSubmit:function(e){e.preventDefault(),e.stopPropagation(),n(),u(Object(y.o)({id:a.id,obj:{name:a.name,code:a.code,isAsync:a.isAsync}}))},children:[Object(_.jsxs)("div",{className:"section",children:[Object(_.jsx)("label",{children:"name"}),Object(_.jsx)("input",{type:"text",value:a.name,onChange:function(e){return i(Object(s.a)(Object(s.a)({},a),{},{name:e.target.value}))}})]}),Object(_.jsxs)("div",{className:"section",children:[Object(_.jsx)("label",{children:"code"}),Object(_.jsx)("textarea",{value:a.code,onChange:function(e){return i(Object(s.a)(Object(s.a)({},a),{},{code:e.target.value}))}})]}),Object(_.jsxs)("div",{className:"section",children:[Object(_.jsx)("label",{children:"async"}),Object(_.jsx)("div",{children:Object(_.jsx)("input",{type:"checkbox",checked:a.isAsync,onChange:function(e){return i(Object(s.a)(Object(s.a)({},a),{},{isAsync:e.target.checked}))}})})]}),Object(_.jsxs)("div",{className:"section footer",children:[Object(_.jsx)("button",{type:"button",className:"button",onClick:n,children:"Cancel"}),Object(_.jsx)("button",{type:"submit",className:"button primary",children:"OK"})]})]})})},w=t(8),I=(t(65),function(e){var n=e.name,t=e.dragData;return Object(_.jsxs)(f,{data:t,className:"Port LeftPort",children:[Object(_.jsx)(w.a,{name:"arrow-right-drop-circle-outline"}),Object(_.jsx)("div",{className:"label",children:n})]})}),R=function(e){var n=e.name,t=e.dragData;return Object(_.jsxs)(f,{data:t,className:"Port RightPort",children:[Object(_.jsx)("div",{className:"label",children:n}),Object(_.jsx)(w.a,{name:"arrow-right-drop-circle-outline"})]})},T=function(e){var n=e.node,t=e.isPreview,r=e.containerRef,o=Object(c.useState)(!1),a=Object(d.a)(o,2),i=a[0],u=a[1],s=Object(h.a)(),l=["Block",n.linked&&"linked",n.isAsync&&"async",t&&"preview"],b=function(){s(Object(y.k)(n))};return Object(_.jsxs)("div",{className:l.filter((function(e){return e})).join(" "),style:{left:n.x,top:n.y},ref:function(e){void 0!==r&&r(e)},children:[Object(_.jsxs)(f,{className:"header",data:{node:n,type:"FuncNodeHeader"},onDoubleClick:function(e){e.stopPropagation(),b()},children:[Object(_.jsxs)("div",{className:"name",children:[n.linked&&Object(_.jsx)(w.a,{name:"link",className:"link-icon"}),n.name]}),Object(_.jsx)("div",{className:"menu-button",onDoubleClick:function(e){return e.stopPropagation()},onClick:function(e){e.stopPropagation(),u(!i)},children:Object(_.jsx)(w.a,{name:"menu-down"})})]}),i&&Object(_.jsx)(k,{items:[{name:"make reference",onClick:function(e){return s(Object(y.c)(n.id))}},{name:"duplicate",onClick:function(e){return s(Object(y.f)(n.id))}},{name:"remove",onClick:function(e){return s(Object(y.i)(n.id))}}],onRequestClose:function(){return u(!1)}}),Object(_.jsxs)("div",{className:"ports",children:[Object(_.jsx)("div",{className:"inputs",children:n.inputNames.map((function(e,t){return Object(_.jsx)(I,{name:e,dragData:{node:n,index:t,type:"FuncNodeInput"}},t)}))}),Object(_.jsx)("div",{className:"outputs",children:Object(_.jsx)(R,{name:"",dragData:{node:n,type:"FuncNodeOutput"}})})]}),!n.linked&&Object(_.jsx)("pre",{className:"code",onDoubleClick:b,children:n.code})]})},A=N.a.div(o||(o=Object(P.a)(["\n  position: absolute;\n"]))),B=function(e){var n=e.node;return Object(_.jsx)(A,{style:{left:n.x,top:n.y},children:n.name})},U=function(){var e=Object(h.b)((function(e){return e.graph})),n=e.current,t=n.nodes,r=n.edges,o=e.previewNode,a=e.editingNode,i=e.previewEdge,u=Object(h.a)(),s=Object(c.useState)(null),l=Object(d.a)(s,2),b=l[0],j=l[1],f=Object(c.useState)({}),O=Object(d.a)(f,2),p=O[0],m=O[1],v=Object(c.useState)(null),x=Object(d.a)(v,2),P=x[0],N=x[1],M=function(e,n){var t=p[e];return void 0===t?{x:0,y:0}:{x:t.offsetLeft,y:t.offsetTop+54+20*n}},w=function(e){var n=p[e];return void 0===n?{x:0,y:0}:{x:n.offsetLeft+n.clientWidth,y:n.offsetTop+54}};return Object(_.jsxs)("div",{onDoubleClick:function(e){var n=e.currentTarget.getBoundingClientRect();N({x:e.clientX-n.left,y:e.clientY-n.top})},className:"Stage",ref:j,children:[null!==b&&Object(_.jsx)(g,{draw:function(e){var n=e.canvas,t=function(n,t){e.beginPath(),e.moveTo(n.x,n.y);var r=.3*Math.abs(t.x-n.x);e.bezierCurveTo(n.x+r,n.y,t.x-r,t.y,t.x,t.y),e.stroke()};e.clearRect(0,0,n.width,n.height),e.lineWidth=2,e.strokeStyle="white";var o,c=Object(E.a)(r);try{for(c.s();!(o=c.n()).done;){var a=o.value;t(w(a.fromId),M(a.toId,a.toIndex))}}catch(u){c.e(u)}finally{c.f()}i&&(e.strokeStyle="rgba(255, 255, 255, 0.2)",t(w(i.fromId),i.toPosition))},width:b.clientWidth,height:b.clientHeight}),Object(y.d)(t).map((function(e){return Object(_.jsx)(T,{node:e,containerRef:function(n){null!=n&&(p[e.id]=n,m(p))}},e.id)})),t.filter(D.c).map((function(e){return Object(_.jsx)(B,{node:e},e.id)})),o&&Object(_.jsx)(T,{isPreview:!0,node:o},"preview"),null!==a&&"FuncNode"===a.type&&Object(_.jsx)(C,{closeModal:function(){u(Object(y.k)(null))},node:a}),P&&Object(_.jsx)(k,{position:P,items:[{name:"new function node",onClick:function(e){var n=e.currentTarget.getBoundingClientRect();u(Object(y.b)(Object(y.e)(e.clientX-n.left,e.clientY-n.top)))}}],onRequestClose:function(){return N(null)}})]})},L=t(40),F=function(){var e=Object(h.b)((function(e){return e.codes}));return Object(_.jsxs)("div",{className:"ToolBox",children:[Object(_.jsx)("div",{className:"header",children:"toolbox"}),e.map((function(e,n){return Object(_.jsxs)(f,{className:"item",data:{code:e,type:"ToolBoxItem"},children:[Object(_.jsx)("div",{className:"name",children:e.name}),Object(_.jsx)(w.a,{name:"arrow-top-right"})]},n)}))]})};function W(){var e=Object(h.b)((function(e){return e.graph.current})),n=e.edges,t=e.nodes,r=Object(x.a)({edges:n,nodes:t});return Object(_.jsx)("div",{className:"CodeOutput",children:Object(_.jsx)("pre",{children:r})})}var K=function(){var e=Object(c.useState)(!1),n=Object(d.a)(e,2),t=n[0],r=n[1],o=function(){var e=Object(h.b)((function(e){return e.graph})),n=e.current,t=(n.nodes,n.edges,e.previewNode),r=Object(h.a)();return{onMouseDown:Object(c.useCallback)((function(e){e.start}),[]),onMouseDragMove:Object(c.useCallback)((function(e){if(null!==e.start)switch(e.start.type){case"FuncNodeHeader":r(Object(y.o)({id:e.start.node.id,obj:{x:e.movement.x+e.start.node.x,y:e.movement.y+e.start.node.y}}));break;case"ToolBoxItem":var n=e.start.code;r(Object(y.n)(Object(s.a)(Object(s.a)({},n),{},{id:0,type:"FuncNode",linked:!1,x:e.startPosition.x+e.movement.x,y:e.startPosition.y+e.movement.y})));break;case"FuncNodeOutput":r(Object(y.m)({fromId:e.start.node.id,toPosition:{x:e.startPosition.x+e.movement.x,y:e.startPosition.y+e.movement.y}}))}}),[r]),onMouseUp:Object(c.useCallback)((function(e){console.log(e),null!==e.start&&(null!==e.end&&("FuncNodeOutput"===e.start.type&&"FuncNodeInput"===e.end.type&&r(Object(y.a)({fromId:e.start.node.id,toId:e.end.node.id,toIndex:e.end.index})),"FuncNodeOutput"===e.start.type&&"FuncNodeOutput"===e.end.type&&e.start.node.id===e.end.node.id&&r(Object(y.h)(e.start.node.id))),"ToolBoxItem"!==e.start.type||null!==e.end&&0!==e.end.node.id||t&&r(Object(y.b)(t))),r(Object(y.n)(null)),r(Object(y.m)(null))}),[t,r])}}();return Object(_.jsxs)("div",{className:"App",children:[Object(_.jsx)(L.a,{onClickHelp:function(){return r(!0)}}),Object(_.jsx)(j,Object(s.a)(Object(s.a)({},o),{},{className:"main",children:Object(_.jsxs)("div",{className:"content",children:[Object(_.jsx)(F,{}),Object(_.jsx)(U,{}),Object(_.jsx)(W,{})]})})),Object(_.jsx)(v,{isOpen:t,close:function(){return r(!1)}})]})},S=(t(66),t(12)),q=t(41),H=Object(S.b)({name:"code",initialState:Object(q.a)(),reducers:{}}),G=Object(S.a)({reducer:{codes:H.reducer,graph:y.g.reducer}});i.a.render(Object(_.jsx)(u.a,{store:G,children:Object(_.jsx)(K,{})}),document.getElementById("root"))},8:function(e,n,t){"use strict";t(1);var r=t(39),o=t.n(r),c=(t(63),t(64),t(0));n.a=function(e){var n=e.component,t=e.name,r=e.className,a=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"div";return e||n}(n);return Object(c.jsx)(a,{className:o()("Icon","mdi","mdi-".concat(t),r)})}}},[[67,1,2]]]);
//# sourceMappingURL=main.ef279732.chunk.js.map